<!DOCTYPE html>
<html>
<head>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <script>
        function toggleMenu() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
        }
    </script>
        
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YMZBTB7JST"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YMZBTB7JST');
    </script>
    
    <!-- Google Adsense tag (gtag.js) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5450333101463376"
    crossorigin="anonymous"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{url_for('static',  filename='style.css')}}" type="text/css">
    <script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
    <script>
        $(function(){
            $('#nfl_navbar').load("{{ url_for('nfl_navbar') }}")
        })
    </script>
    <script>
        $(function(){
            $('#header').load("{{ url_for('header') }}")
        })
    </script>
    <body>
        <div id="header"></div>
        <div id="nfl_navbar"></div>
        
        <h1>🎯 NFL Opportunity Tracker</h1>
        <h2>{{ selected_year }} Season</h2>
        
        {% if loading %}
            <div class="loading-message">
                <p>📊 Opportunity data is being calculated from play-by-play data...</p>
                <p>Please refresh the page in a moment.</p>
            </div>
        {% else %}
            <div style="text-align: center; margin: 20px 0;">
                <a href="{{ url_for('update_opportunities') }}" style="font-size: 16px; padding: 10px 20px; background-color: #28a745; color: white; text-decoration: none; border-radius: 5px;">
                    🔄 Update Opportunity Data
                </a>
            </div>
            
            <div class="opportunity-section">
                <h2>🔥 Trending Up - Targets</h2>
                <p>Players with increasing target opportunities (>20% increase)</p>
                <div class="table-wrapper">
                    {{ insights.trending_up_targets | safe }}
                </div>
            </div>
            
            <div class="opportunity-section">
                <h2>🏃 Trending Up - Carries</h2>
                <p>Players with increasing rushing opportunities (>20% increase)</p>
                <div class="table-wrapper">
                    {{ insights.trending_up_carries | safe }}
                </div>
            </div>
            
            <div class="nfl-row">
                <div class="nfl-column">
                    <h2>👑 Target Leaders</h2>
                    <p>Highest average targets per game</p>
                    <div class="table-wrapper">
                        {{ insights.target_leaders | safe }}
                    </div>
                </div>
                <div class="nfl-column">
                    <h2>🏃‍♂️ Carry Leaders</h2>
                    <p>Highest average carries per game</p>
                    <div class="table-wrapper">
                        {{ insights.carry_leaders | safe }}
                    </div>
                </div>
            </div>
            
            <div class="opportunity-section">
                <h2>📉 Declining Opportunities</h2>
                <p>Players losing touches (>20% decrease)</p>
                <div class="table-wrapper">
                    {{ insights.declining_opportunities | safe }}
                </div>
            </div>
            
            <div class="team-links">
                <h2>🏈 Team Opportunity Analysis</h2>
                <p>Click a team to see detailed opportunity breakdowns:</p>
                <div class="teams-grid">
                    <a href="{{url_for('team_opportunities', team='ARI')}}" class="team-link">Arizona Cardinals</a>
                    <a href="{{url_for('team_opportunities', team='ATL')}}" class="team-link">Atlanta Falcons</a>
                    <a href="{{url_for('team_opportunities', team='BAL')}}" class="team-link">Baltimore Ravens</a>
                    <a href="{{url_for('team_opportunities', team='BUF')}}" class="team-link">Buffalo Bills</a>
                    <a href="{{url_for('team_opportunities', team='CAR')}}" class="team-link">Carolina Panthers</a>
                    <a href="{{url_for('team_opportunities', team='CHI')}}" class="team-link">Chicago Bears</a>
                    <a href="{{url_for('team_opportunities', team='CIN')}}" class="team-link">Cincinnati Bengals</a>
                    <a href="{{url_for('team_opportunities', team='CLE')}}" class="team-link">Cleveland Browns</a>
                    <a href="{{url_for('team_opportunities', team='DAL')}}" class="team-link">Dallas Cowboys</a>
                    <a href="{{url_for('team_opportunities', team='DEN')}}" class="team-link">Denver Broncos</a>
                    <a href="{{url_for('team_opportunities', team='DET')}}" class="team-link">Detroit Lions</a>
                    <a href="{{url_for('team_opportunities', team='GB')}}" class="team-link">Green Bay Packers</a>
                    <a href="{{url_for('team_opportunities', team='HOU')}}" class="team-link">Houston Texans</a>
                    <a href="{{url_for('team_opportunities', team='IND')}}" class="team-link">Indianapolis Colts</a>
                    <a href="{{url_for('team_opportunities', team='JAX')}}" class="team-link">Jacksonville Jaguars</a>
                    <a href="{{url_for('team_opportunities', team='KC')}}" class="team-link">Kansas City Chiefs</a>
                    <a href="{{url_for('team_opportunities', team='LA')}}" class="team-link">Los Angeles Rams</a>
                    <a href="{{url_for('team_opportunities', team='LAC')}}" class="team-link">Los Angeles Chargers</a>
                    <a href="{{url_for('team_opportunities', team='LV')}}" class="team-link">Las Vegas Raiders</a>
                    <a href="{{url_for('team_opportunities', team='MIA')}}" class="team-link">Miami Dolphins</a>
                    <a href="{{url_for('team_opportunities', team='MIN')}}" class="team-link">Minnesota Vikings</a>
                    <a href="{{url_for('team_opportunities', team='NE')}}" class="team-link">New England Patriots</a>
                    <a href="{{url_for('team_opportunities', team='NO')}}" class="team-link">New Orleans Saints</a>
                    <a href="{{url_for('team_opportunities', team='NYG')}}" class="team-link">New York Giants</a>
                    <a href="{{url_for('team_opportunities', team='NYJ')}}" class="team-link">New York Jets</a>
                    <a href="{{url_for('team_opportunities', team='PHI')}}" class="team-link">Philadelphia Eagles</a>
                    <a href="{{url_for('team_opportunities', team='PIT')}}" class="team-link">Pittsburgh Steelers</a>
                    <a href="{{url_for('team_opportunities', team='SEA')}}" class="team-link">Seattle Seahawks</a>
                    <a href="{{url_for('team_opportunities', team='SF')}}" class="team-link">San Francisco 49ers</a>
                    <a href="{{url_for('team_opportunities', team='TB')}}" class="team-link">Tampa Bay Buccaneers</a>
                    <a href="{{url_for('team_opportunities', team='TEN')}}" class="team-link">Tennessee Titans</a>
                    <a href="{{url_for('team_opportunities', team='WAS')}}" class="team-link">Washington Commanders</a>
                </div>
            </div>
        {% endif %}
    </body>
</head>
</html>
